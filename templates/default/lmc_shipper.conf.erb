input {
  <% node[:logstash][:agent][:input_template_partials].each do |filter| %>
  <%= render "shipper/inputs/#{filter}", cookbook: "cybera_logstash" %>
  <% end %>
}

filter {
  mutate {
    add_field => ["institution", "<%= node[:institution] %>"]
  }
  mutate {
    update => ["host", "%{institution}-%{host}"]
  }
  <% node[:logstash][:agent][:filter_template_partials].each do |filter| %>
  <%= render "shipper/filters/#{filter}", cookbook: "cybera_logstash", variables: {patterns_dir: @patterns_dir} %>
  <% end %>
}

output {
  <% node[:logstash][:agent][:output_template_partials].each do |filter| %>
  <%= render "shipper/outputs/#{filter}", cookbook: "cybera_logstash" %>
  <% end %>
}